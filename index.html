<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWH Campus Assistant</title>
    <style>
        /* =========================================
           THEME & VARIABLES 
           ========================================= */
        :root {
            --primary: #0d47a1;       /* AWH Blue */
            --primary-dark: #002171;
            --bg-color: #f0f2f5;
            --chat-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #666666;
            --bot-bubble: #e3f2fd;
            --user-bubble: #0d47a1;
            --user-text: #ffffff;
            --shadow: rgba(0,0,0,0.1);
        }

        /* DARK MODE VARIABLES */
        [data-theme="dark"] {
            --bg-color: #121212;
            --chat-bg: #1e1e1e;
            --text-main: #e0e0e0;
            --text-sub: #aaaaaa;
            --bot-bubble: #2c2c2c;
            --user-bubble: #3f51b5; /* Slightly lighter blue for dark mode contrast */
            --shadow: rgba(0,0,0,0.4);
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            transition: background-color 0.3s;
        }

        /* =========================================
           CHAT CONTAINER
           ========================================= */
        .chat-wrapper {
            width: 100%;
            max-width: 400px;
            height: 90vh;
            max-height: 700px;
            background-color: var(--chat-bg);
            border-radius: 20px;
            box-shadow: 0 10px 30px var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        /* Fullscreen on small mobile phones */
        @media (max-width: 450px) {
            .chat-wrapper {
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }
        }

        /* =========================================
           HEADER
           ========================================= */
        .header {
            background-color: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between; /* Spreads title and toggle */
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .theme-toggle:hover {
            background-color: rgba(255,255,255,0.2);
        }

        /* =========================================
           CHAT AREA
           ========================================= */
        .messages-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            scroll-behavior: smooth;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.5;
            position: relative;
            word-wrap: break-word;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.9) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .bot {
            background-color: var(--bot-bubble);
            color: var(--text-main);
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .user {
            background-color: var(--user-bubble);
            color: var(--user-text);
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        /* Formatting Helpers */
        .message strong {
            font-weight: 700;
        }
        .message ul {
            margin: 5px 0 5px 20px;
            padding: 0;
        }
        .message li {
            margin-bottom: 4px;
        }

        /* =========================================
           CONTROLS
           ========================================= */
        .quick-actions {
            padding: 10px 15px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            background-color: var(--chat-bg);
            border-top: 1px solid rgba(0,0,0,0.05);
            scrollbar-width: none; /* Firefox */
        }
        .quick-actions::-webkit-scrollbar { display: none; } /* Chrome */

        .pill {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .pill:hover {
            background-color: var(--primary);
            color: white;
        }

        /* Dark mode adjustments for pills */
        [data-theme="dark"] .pill {
            border-color: #64b5f6;
            color: #64b5f6;
        }
        [data-theme="dark"] .pill:hover {
            background-color: #64b5f6;
            color: #121212;
        }

        .input-box {
            padding: 15px;
            background-color: var(--chat-bg);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            background-color: var(--bg-color);
            color: var(--text-main);
            transition: border-color 0.2s;
        }

        input:focus {
            border-color: var(--primary);
        }

        .send-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        /* =========================================
           TYPING INDICATOR (ANIMATION)
           ========================================= */
        .typing-indicator {
            display: none;
            padding: 10px 15px;
            background-color: var(--bot-bubble);
            border-radius: 18px;
            align-self: flex-start;
            margin-left: 20px;
            margin-bottom: 10px;
            width: fit-content;
        }

        .dots {
            display: flex;
            gap: 4px;
        }

        .dot {
            width: 6px;
            height: 6px;
            background-color: #888;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div class="chat-wrapper">
    <div class="header">
        <div class="header-title">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 0 6-1 9-1 3 0 6 0 9 1v-5"/></svg>
            AWH Bot
        </div>
        <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
            üåô
        </button>
    </div>

    <div class="messages-area" id="chatBox">
        <div class="message bot">
            Hello! üëã I'm your AWH Engineering College virtual assistant.<br><br>
            <strong>I can help you with:</strong><br>
            ‚Ä¢ Departments & Courses<br>
            ‚Ä¢ Saaya & ATHMA Fests<br>
            ‚Ä¢ Campus Location<br><br>
            Ask me anything! üòä
        </div>
    </div>

    <div class="typing-indicator" id="loader">
        <div class="dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
    </div>

    <div class="quick-actions">
        <button class="pill" onclick="sendQuick('Departments')">Departments</button>
        <button class="pill" onclick="sendQuick('Courses')">Courses</button>
        <button class="pill" onclick="sendQuick('Events')">Events</button>
        <button class="pill" onclick="sendQuick('Location')">Location</button>
    </div>

    <div class="input-box">
        <input type="text" id="userInput" placeholder="Type your query..." onkeypress="handleEnter(event)">
        <button class="send-btn" onclick="sendMessage()">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
        </button>
    </div>
</div>

<script>
    // ===============================================
    // ‚ö†Ô∏è CONFIGURATION: PASTE API KEY HERE
    // ===============================================
    const API_KEY = "AIzaSyDKbOtWve9E0G-fws_B-jg5N7I-C5u0CDI"; 
    // ===============================================

    const chatBox = document.getElementById('chatBox');
    const userInput = document.getElementById('userInput');
    const loader = document.getElementById('loader');

    // 1. HARDCODED KNOWLEDGE BASE
    const collegeData = {
        name: "AWH Engineering College",
        
        departments: `<strong>Our Departments:</strong>
        <ul>
            <li>Computer Science (CSE)</li>
            <li>AI & Data Science (AI&DS)</li>
            <li>Electronics (ECE)</li>
            <li>Electrical (EEE)</li>
            <li>Mechanical (ME)</li>
            <li>Civil (CE)</li>
            <li>MCA</li>
        </ul>`,
        
        courses: `<strong>Courses Offered:</strong><br>
        We offer B.Tech programs affiliated with KTU in all major engineering branches.<br><br>
        <strong>Postgraduate Options:</strong><br>
        ‚Ä¢ MCA<br>
        ‚Ä¢ M.Tech in Structural Eng, CSE, and VLSI Design.`,
        
        events: `<strong>üéâ Saaya (Cultural Fest):</strong><br>
        Our massive annual arts festival! It's a kaleidoscope of music, dance, and fine arts where students showcase their creative side.<br><br>
        <strong>ü§ñ ATHMA (Technical Fest):</strong><br>
        The flagship tech fest! Features the 'ATHMATHON' hackathon, robotics wars, and coding challenges. It's where innovation happens.`,
        
        location: `<strong>Find Us Here:</strong><br>
        üìç Kuttikkattoor, Kozhikode, Kerala - 673008.<br>
        (We are about 12km from the main Kozhikode city).`,

        contact: `üìû 0495-2352552<br>üìß info@awhengg.org`
    };

    // 2. THEME TOGGLE LOGIC
    let isDark = false;
    function toggleTheme() {
        isDark = !isDark;
        document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
        document.querySelector('.theme-toggle').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
    }

    // 3. CHAT LOGIC
    function handleEnter(e) {
        if (e.key === 'Enter') sendMessage();
    }

    function sendQuick(text) {
        userInput.value = text;
        sendMessage();
    }

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        // Add User Message
        addMessage(text, 'user');
        userInput.value = '';

        // Check Hardcoded Data First
        const lower = text.toLowerCase();
        let reply = null;

        if (lower.includes('department') || lower.includes('branch')) reply = collegeData.departments;
        else if (lower.includes('course') || lower.includes('b.tech') || lower.includes('m.tech')) reply = collegeData.courses;
        else if (lower.includes('event') || lower.includes('saaya') || lower.includes('athma')) reply = collegeData.events;
        else if (lower.includes('location') || lower.includes('where') || lower.includes('address')) reply = collegeData.location;
        else if (lower.includes('contact') || lower.includes('phone') || lower.includes('email')) reply = collegeData.contact;

        if (reply) {
            // Simulate brief "thinking" for natural feel
            showLoader(true);
            setTimeout(() => {
                showLoader(false);
                addMessage(reply, 'bot');
            }, 600);
        } else {
            // Use AI
            showLoader(true);
            try {
                const aiReply = await fetchGemini(text);
                showLoader(false);
                addMessage(parseMarkdown(aiReply), 'bot');
            } catch (err) {
                showLoader(false);
                addMessage("‚ö†Ô∏è Network error. Please check your connection or API Key.", 'bot');
            }
        }
    }

    // 4. DISPLAY FUNCTIONS
    function addMessage(html, type) {
        const div = document.createElement('div');
        div.className = `message ${type}`;
        div.innerHTML = html;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function showLoader(show) {
        loader.style.display = show ? 'block' : 'none';
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Simple Markdown Parser (Bold only for safety)
    function parseMarkdown(text) {
        // Convert **bold** to <b>bold</b>
        let parsed = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        // Convert * bullet to bullet point
        parsed = parsed.replace(/^\* /gm, '‚Ä¢ ');
        return parsed;
    }

    // 5. API CONNECTION
    async function fetchGemini(prompt) {
        if (!API_KEY || API_KEY.includes("PASTE")) return "Please set up your API Key in the code file!";

        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`;
        const payload = {
            contents: [{
                parts: [{
                    text: `You are an enthusiastic senior student volunteer at AWH Engineering College. 
                    User: "${prompt}"
                    
                    Guidelines:
                    1. Be friendly, helpful, and use emojis occasionally.
                    2. If asked about facts you don't know (like specific fees or exam dates), politely guide them to the college office.
                    3. Keep answers short (under 50 words) unless asked to elaborate.
                    4. Never mention you are an AI; pretend to be a helpful student.`
                }]
            }]
        };

        const res = await fetch(url, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(payload)
        });
        
        const data = await res.json();
        return data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I didn't catch that.";
    }
</script>

</body>
</html>
